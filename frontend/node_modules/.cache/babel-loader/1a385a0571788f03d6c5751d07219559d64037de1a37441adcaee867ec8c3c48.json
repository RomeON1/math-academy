{"ast":null,"code":"var _jsxFileName = \"/opt/math-app/frontend/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useCallback } from \"react\";\nimport Header from \"./components/Header\";\nimport Login from \"./components/auth/Login\";\nimport Register from \"./components/auth/Register\";\nimport { authAPI, courseAPI, userAPI } from './services/api';\nimport { courseStructure } from './taskGenerators';\nimport * as taskGenerators from './taskGenerators';\nimport { useTranslation } from 'react-i18next';\nimport DayNavigation from './components/DayNavigation';\n\n// Функция для применения переводов к заданиям\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst applyTranslationsToTasks = (tasks, t) => {\n  return tasks.map(task => ({\n    ...task,\n    question: task.translationKey ? t(task.translationKey, task.translationParams) : task.question,\n    explanation: task.explanationKey ? t(task.explanationKey, task.explanationParams) : task.explanation,\n    answerFormat: task.formatKey ? t(task.formatKey) : task.answerFormat\n  }));\n};\n\n// 🟢 ФУНКЦИЯ ДЛЯ СИНХРОНИЗАЦИИ ПРОГРЕССА\nconst syncProgressWithServer = async (localAnswers, localTests) => {\n  try {\n    // Сохраняем тесты на сервер\n    if (localTests && localTests.length > 0) {\n      for (const dayData of localTests) {\n        await userAPI.saveTasks(dayData.day, dayData.tasks);\n      }\n    }\n\n    // Сохраняем ответы на сервер\n    if (localAnswers && Object.keys(localAnswers).length > 0) {\n      for (const [key, answer] of Object.entries(localAnswers)) {\n        const [day, index] = key.split('-').map(Number);\n        const dayData = localTests.find(d => d.day === day);\n        if (dayData && dayData.tasks[index]) {\n          const task = dayData.tasks[index];\n          const isCorrectAnswer = isCorrectAnswerCheck(day, index, task.answer, localAnswers);\n          await userAPI.saveAnswer(day, index, answer, isCorrectAnswer);\n        }\n      }\n    }\n    console.log('✅ Прогресс синхронизирован с сервером');\n    return true;\n  } catch (error) {\n    console.error('❌ Ошибка синхронизации прогресса:', error);\n    return false;\n  }\n};\n\n// 🟢 ФУНКЦИЯ ДЛЯ ЗАГРУЗКИ ПРОГРЕССА С СЕРВЕРА\nconst loadProgressFromServer = async () => {\n  try {\n    const [progressResponse, answersResponse, tasksResponse] = await Promise.all([courseAPI.getProgress().catch(() => ({\n      data: {}\n    })), userAPI.getAnswers('all').catch(() => ({\n      data: {}\n    })), userAPI.getTasks('all').catch(() => ({\n      data: {}\n    }))]);\n    const serverProgress = {\n      answers: answersResponse.data || {},\n      tests: tasksResponse.data || {},\n      progress: progressResponse.data || {}\n    };\n    console.log('📥 Прогресс загружен с сервера:', serverProgress);\n    return serverProgress;\n  } catch (error) {\n    console.error('❌ Ошибка загрузки прогресса с сервера:', error);\n    return {\n      answers: {},\n      tests: {},\n      progress: {}\n    };\n  }\n};\n\n// 🟢 ФУНКЦИЯ ПРОВЕРКИ ПРАВИЛЬНОСТИ ОТВЕТА (вынесена для переиспользования)\nconst isCorrectAnswerCheck = (day, index, correctAnswer, currentAnswers) => {\n  var _currentAnswers;\n  const userAnswer = (_currentAnswers = currentAnswers[`${day}-${index}`]) === null || _currentAnswers === void 0 ? void 0 : _currentAnswers.toString().trim().toLowerCase();\n  const correct = correctAnswer.toString().toLowerCase();\n  if (!userAnswer) return false;\n  if (correct.includes('%')) {\n    const userNum = userAnswer.replace('%', '');\n    const correctNum = correct.replace('%', '');\n    return userNum === correctNum;\n  }\n  if (correct.includes('/')) {\n    const [userA, userB] = userAnswer.split('/');\n    const [correctA, correctB] = correct.split('/');\n    return userA === correctA && userB === correctB;\n  }\n  return userAnswer === correct;\n};\nfunction App() {\n  _s();\n  const {\n    t,\n    i18n\n  } = useTranslation();\n  const [tests, setTests] = useState([]);\n  const [answers, setAnswers] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [showResetConfirm, setShowResetConfirm] = useState(false);\n  const [user, setUser] = useState(null);\n  const [showLogin, setShowLogin] = useState(false);\n  const [showRegister, setShowRegister] = useState(false);\n  const [currentDay, setCurrentDay] = useState(1);\n  const [showScrollTop, setShowScrollTop] = useState(false);\n  const [authError, setAuthError] = useState('');\n  const [isSyncing, setIsSyncing] = useState(false);\n  const [progressLoaded, setProgressLoaded] = useState(false);\n\n  // 🟢 EFFECT ДЛЯ ОТСЛЕЖИВАНИЯ СКРОЛЛА\n  useEffect(() => {\n    const handleScroll = () => {\n      setShowScrollTop(window.scrollY > 300);\n    };\n    window.addEventListener('scroll', handleScroll);\n    return () => window.removeEventListener('scroll', handleScroll);\n  }, []);\n\n  // 🟢 УЛУЧШЕННАЯ ИНИЦИАЛИЗАЦИЯ ПРОГРЕССА ПОЛЬЗОВАТЕЛЯ\n  const initializeUserProgress = useCallback(async () => {\n    if (progressLoaded) return; // Защита от повторной загрузки\n\n    setIsSyncing(true);\n    try {\n      // 1. Всегда загружаем прогресс с сервера для авторизованных пользователей\n      const serverProgress = await loadProgressFromServer();\n\n      // 2. Проверяем localStorage\n      const localTests = localStorage.getItem('userMathTests');\n      const localAnswers = localStorage.getItem('userMathAnswers');\n      let finalTests = [];\n      let finalAnswers = {};\n\n      // 3. ДЛЯ АВТОРИЗОВАННЫХ ПОЛЬЗОВАТЕЛЕЙ: приоритет у сервера\n      if (user && user.isLoggedIn) {\n        if (serverProgress.tests && Object.keys(serverProgress.tests).length > 0) {\n          // Используем данные с сервера\n          finalTests = Object.values(serverProgress.tests).map(dayData => ({\n            ...dayData,\n            tasks: applyTranslationsToTasks(dayData.tasks, t)\n          }));\n          finalAnswers = serverProgress.answers || {};\n          console.log('🔄 Используем данные с сервера для авторизованного пользователя');\n        } else if (localTests && localAnswers) {\n          // Сервер пустой, но есть локальные данные - синхронизируем\n          const parsedTests = JSON.parse(localTests);\n          const parsedAnswers = JSON.parse(localAnswers);\n          finalTests = parsedTests.map(dayData => ({\n            ...dayData,\n            tasks: applyTranslationsToTasks(dayData.tasks, t)\n          }));\n          finalAnswers = parsedAnswers;\n          await syncProgressWithServer(parsedAnswers, parsedTests);\n          console.log('🔄 Синхронизировали локальные данные с сервером');\n        } else {\n          // Нет данных вообще - генерируем новые\n          finalTests = courseStructure.map(day => ({\n            day: day.day,\n            titleKey: day.titleKey,\n            theoryLink: day.theoryLink,\n            tasks: taskGenerators[day.generator](day.taskCount, t)\n          }));\n          await syncProgressWithServer({}, finalTests);\n          console.log('🔄 Сгенерировали новые задания для авторизованного пользователя');\n        }\n      }\n      // 4. ДЛЯ ГОСТЕЙ: используем только localStorage\n      else {\n        if (localTests && localAnswers) {\n          const parsedTests = JSON.parse(localTests);\n          const parsedAnswers = JSON.parse(localAnswers);\n          finalTests = parsedTests.map(dayData => ({\n            ...dayData,\n            tasks: applyTranslationsToTasks(dayData.tasks, t)\n          }));\n          finalAnswers = parsedAnswers;\n          console.log('🔄 Используем локальные данные для гостя');\n        } else {\n          finalTests = courseStructure.map(day => ({\n            day: day.day,\n            titleKey: day.titleKey,\n            theoryLink: day.theoryLink,\n            tasks: taskGenerators[day.generator](day.taskCount, t)\n          }));\n          console.log('🔄 Сгенерировали новые задания для гостя');\n        }\n      }\n\n      // 5. Сохраняем финальные данные\n      setTests(finalTests);\n      setAnswers(finalAnswers);\n      localStorage.setItem('userMathTests', JSON.stringify(finalTests));\n      localStorage.setItem('userMathAnswers', JSON.stringify(finalAnswers));\n      setProgressLoaded(true);\n    } catch (error) {\n      console.error('❌ Ошибка инициализации прогресса:', error);\n\n      // Фолбэк на localStorage или новую генерацию\n      const localTests = localStorage.getItem('userMathTests');\n      const localAnswers = localStorage.getItem('userMathAnswers');\n      if (localTests && localAnswers) {\n        const parsedTests = JSON.parse(localTests);\n        const parsedAnswers = JSON.parse(localAnswers);\n        setTests(parsedTests.map(dayData => ({\n          ...dayData,\n          tasks: applyTranslationsToTasks(dayData.tasks, t)\n        })));\n        setAnswers(parsedAnswers);\n      } else {\n        const newTests = courseStructure.map(day => ({\n          day: day.day,\n          titleKey: day.titleKey,\n          theoryLink: day.theoryLink,\n          tasks: taskGenerators[day.generator](day.taskCount, t)\n        }));\n        setTests(newTests);\n        localStorage.setItem('userMathTests', JSON.stringify(newTests));\n      }\n      setProgressLoaded(true);\n    } finally {\n      setIsSyncing(false);\n    }\n  }, [user, t, progressLoaded]);\n\n  // 🟢 ПРОВЕРКА АУТЕНТИФИКАЦИИ С СИНХРОНИЗАЦИЕЙ ПРОГРЕССА\n  const checkAuth = useCallback(async () => {\n    try {\n      const token = localStorage.getItem('authToken');\n      const savedUser = localStorage.getItem('userData');\n      if (token && savedUser) {\n        const userData = JSON.parse(savedUser);\n        setUser(userData);\n\n        // 🟢 ЗАГРУЖАЕМ И СИНХРОНИЗИРУЕМ ПРОГРЕСС ПОСЛЕ ЛОГИНА\n        if (userData.isLoggedIn) {\n          await initializeUserProgress();\n        }\n      } else if (token) {\n        try {\n          const response = await authAPI.getMe();\n          const userData = {\n            ...response.data,\n            isLoggedIn: true\n          };\n          setUser(userData);\n          localStorage.setItem('userData', JSON.stringify(userData));\n\n          // 🟢 ЗАГРУЖАЕМ И СИНХРОНИЗИРУЕМ ПРОГРЕСС\n          await initializeUserProgress();\n        } catch (error) {\n          console.log('getMe failed, using fallback user');\n          const userData = {\n            name: 'Пользователь',\n            email: 'user@example.com',\n            isLoggedIn: true\n          };\n          setUser(userData);\n          localStorage.setItem('userData', JSON.stringify(userData));\n        }\n      } else {\n        setUser({\n          name: t('header.guest', \"Гость\"),\n          isLoggedIn: false\n        });\n        await initializeUserProgress(); // Загружаем прогресс для гостя\n      }\n    } catch (error) {\n      console.error('Auth check error:', error);\n      setUser({\n        name: t('header.guest', \"Гость\"),\n        isLoggedIn: false\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, [t, initializeUserProgress]);\n  useEffect(() => {\n    checkAuth();\n  }, [checkAuth]);\n\n  // 🟢 КРИТИЧЕСКИЙ FIX: ВОССТАНОВЛЕНИЕ ПРОГРЕССА ПРИ СБРОСЕ КЭША SAFARI\n  useEffect(() => {\n    const handleCacheClearRecovery = async () => {\n      // Если пользователь авторизован, но прогресс пустой - загружаем с сервера\n      const token = localStorage.getItem('authToken');\n      const hasTests = tests.length > 0;\n      const hasAnswers = Object.keys(answers).length > 0;\n      const hasLocalData = localStorage.getItem('userMathTests') && localStorage.getItem('userMathAnswers');\n      if (token && (!hasTests || !hasAnswers || !hasLocalData)) {\n        console.log('🔄 Safari cache clear detected - recovering progress from server...');\n        setIsSyncing(true);\n        try {\n          const serverProgress = await loadProgressFromServer();\n          if (serverProgress.tests && Object.keys(serverProgress.tests).length > 0) {\n            const recoveredTests = Object.values(serverProgress.tests).map(dayData => ({\n              ...dayData,\n              tasks: applyTranslationsToTasks(dayData.tasks, t)\n            }));\n            const recoveredAnswers = serverProgress.answers || {};\n            setTests(recoveredTests);\n            setAnswers(recoveredAnswers);\n            localStorage.setItem('userMathTests', JSON.stringify(recoveredTests));\n            localStorage.setItem('userMathAnswers', JSON.stringify(recoveredAnswers));\n            console.log('✅ Progress recovered from server after Safari cache clear');\n          } else {\n            // Если на сервере нет данных, но пользователь авторизован - генерируем новые\n            const newTests = courseStructure.map(day => ({\n              day: day.day,\n              titleKey: day.titleKey,\n              theoryLink: day.theoryLink,\n              tasks: taskGenerators[day.generator](day.taskCount, t)\n            }));\n            setTests(newTests);\n            localStorage.setItem('userMathTests', JSON.stringify(newTests));\n            await syncProgressWithServer({}, newTests);\n            console.log('🔄 Generated new tasks after cache clear');\n          }\n        } catch (error) {\n          console.error('❌ Recovery failed:', error);\n        } finally {\n          setIsSyncing(false);\n        }\n      }\n    };\n\n    // Запускаем проверку после полной загрузки компонента\n    const timer = setTimeout(handleCacheClearRecovery, 2000);\n    return () => clearTimeout(timer);\n  }, [user, tests.length, Object.keys(answers).length, t]);\n\n  // 🟢 ОБРАБОТЧИК ВХОДА С СИНХРОНИЗАЦИЕЙ\n  const handleLogin = async formData => {\n    console.log('🔐 LOGIN ATTEMPT:', formData);\n    setAuthError('');\n    try {\n      const response = await authAPI.login({\n        email: formData.email,\n        password: formData.password\n      });\n      console.log('✅ LOGIN SUCCESS:', response.data);\n      localStorage.setItem('authToken', response.data.access_token);\n      await checkAuth(); // Это вызовет initializeUserProgress\n      setShowLogin(false);\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('❌ LOGIN ERROR:', error);\n      const errorMessage = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.detail) || error.message || 'Ошибка входа';\n      setAuthError(errorMessage);\n    }\n  };\n\n  // 🟢 ОБРАБОТЧИК РЕГИСТРАЦИИ\n  const handleRegister = async formData => {\n    console.log('📝 REGISTER ATTEMPT:', formData);\n    setAuthError('');\n    try {\n      const response = await authAPI.register({\n        email: formData.email,\n        username: formData.username,\n        password: formData.password,\n        grade: formData.grade\n      });\n      console.log('✅ REGISTER SUCCESS:', response.data);\n      const loginResponse = await authAPI.login({\n        email: formData.email,\n        password: formData.password\n      });\n      localStorage.setItem('authToken', loginResponse.data.access_token);\n      await checkAuth();\n      setShowRegister(false);\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      console.error('❌ REGISTER ERROR:', error);\n      const errorMessage = ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.detail) || error.message || 'Ошибка регистрации';\n      setAuthError(errorMessage);\n    }\n  };\n  const handleLogout = () => {\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('userData');\n    localStorage.removeItem('userMathTests');\n    localStorage.removeItem('userMathAnswers');\n    setUser({\n      name: t('header.guest', \"Гость\"),\n      isLoggedIn: false\n    });\n    setAnswers({});\n    setTests([]);\n    setAuthError('');\n    setProgressLoaded(false);\n  };\n\n  // 🟢 УЛУЧШЕННАЯ ОБРАБОТКА ВВОДА ОТВЕТА С СИНХРОНИЗАЦИЕЙ\n  const handleAnswerChange = async (day, index, value) => {\n    const newAnswers = {\n      ...answers,\n      [`${day}-${index}`]: value\n    };\n\n    // Немедленно обновляем UI\n    setAnswers(newAnswers);\n    localStorage.setItem('userMathAnswers', JSON.stringify(newAnswers));\n    try {\n      const dayData = tests.find(d => d.day === day);\n      if (dayData) {\n        const task = dayData.tasks[index];\n        const isCorrectAnswer = isCorrectAnswerCheck(day, index, task.answer, newAnswers);\n\n        // Сохраняем ответ на сервер\n        await userAPI.saveAnswer(day, index, value, isCorrectAnswer);\n\n        // Обновляем прогресс дня\n        const completedTasks = dayData.tasks.filter((t, i) => isCorrectAnswerCheck(day, i, t.answer, newAnswers)).length;\n        await courseAPI.updateProgress(day, newAnswers, completedTasks);\n        console.log('✅ Ответ сохранен и синхронизирован');\n      }\n    } catch (error) {\n      console.error('❌ Ошибка сохранения в базу:', error);\n      // Ответ останется в localStorage и будет синхронизирован при следующей возможности\n    }\n  };\n\n  // Прогресс дня\n  const getDayProgress = (day, tasks) => {\n    const correctCount = tasks.filter((t, i) => isCorrectAnswerCheck(day, i, t.answer, answers)).length;\n    return Math.round(correctCount / tasks.length * 100);\n  };\n\n  // Общий прогресс\n  const getTotalProgress = () => {\n    let totalCorrect = 0;\n    let totalTasks = 0;\n    tests.forEach(dayData => {\n      dayData.tasks.forEach((task, index) => {\n        totalTasks++;\n        if (isCorrectAnswerCheck(dayData.day, index, task.answer, answers)) {\n          totalCorrect++;\n        }\n      });\n    });\n    return totalTasks ? Math.round(totalCorrect / totalTasks * 100) : 0;\n  };\n\n  // 🟢 УЛУЧШЕННЫЙ СБРОС ПРОГРЕССА\n  const resetProgress = async () => {\n    try {\n      // Генерируем новые задания\n      const userTests = courseStructure.map(day => ({\n        day: day.day,\n        titleKey: day.titleKey,\n        theoryLink: day.theoryLink,\n        tasks: taskGenerators[day.generator](day.taskCount, t)\n      }));\n\n      // Обновляем состояние\n      setTests(userTests);\n      setAnswers({});\n\n      // Сохраняем локально\n      localStorage.setItem('userMathTests', JSON.stringify(userTests));\n      localStorage.setItem('userMathAnswers', JSON.stringify({}));\n\n      // Синхронизируем с сервером\n      await courseAPI.resetProgress();\n\n      // Сохраняем новые тесты на сервер\n      for (const dayData of userTests) {\n        await userAPI.saveTasks(dayData.day, dayData.tasks);\n      }\n      console.log('✅ Прогресс полностью сброшен и синхронизирован');\n    } catch (error) {\n      console.error('❌ Error resetting progress:', error);\n      // Локальные данные уже сброшены, сервер синхронизируется при следующей возможности\n    }\n  };\n  const handleLoginClick = () => {\n    setShowLogin(true);\n    setAuthError('');\n  };\n  const handleRegisterClick = () => {\n    setShowRegister(true);\n    setAuthError('');\n  };\n  const handleDayClick = dayNumber => {\n    setCurrentDay(dayNumber);\n    const element = document.getElementById(`day-${dayNumber}`);\n    if (element) {\n      const headerOffset = 340;\n      const elementPosition = element.offsetTop;\n      const offsetPosition = elementPosition - headerOffset;\n      setTimeout(() => {\n        window.scrollTo({\n          top: Math.max(0, offsetPosition),\n          behavior: 'smooth'\n        });\n      }, 50);\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-4 text-gray-600 dark:text-gray-400\",\n          children: t('loading', \"Загрузка...\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 532,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200\",\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      user: user || {\n        name: t('header.guest', \"Гость\"),\n        isLoggedIn: false\n      },\n      progress: getTotalProgress(),\n      onResetClick: () => setShowResetConfirm(true),\n      onSettingsClick: () => console.log(\"Settings clicked\"),\n      onLoginClick: handleLoginClick,\n      onLogoutClick: handleLogout,\n      grade: \"6\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 543,\n      columnNumber: 7\n    }, this), showLogin && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(Login, {\n        onLogin: handleLogin,\n        onSwitchToRegister: () => {\n          setShowLogin(false);\n          setShowRegister(true);\n          setAuthError('');\n        },\n        error: authError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 555,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 554,\n      columnNumber: 9\n    }, this), showRegister && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(Register, {\n        onRegister: handleRegister,\n        onSwitchToLogin: () => {\n          setShowRegister(false);\n          setShowLogin(true);\n          setAuthError('');\n        },\n        error: authError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 569,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 568,\n      columnNumber: 9\n    }, this), isSyncing && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed top-20 left-1/2 transform -translate-x-1/2 z-40 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 583,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: t('syncing', \"Синхронизация прогресса...\")\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 584,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 582,\n      columnNumber: 9\n    }, this), user && user.id && tests.length > 0 && /*#__PURE__*/_jsxDEV(DayNavigation, {\n      days: tests.map(day => ({\n        ...day,\n        progress: getDayProgress(day.day, day.tasks)\n      })),\n      currentDay: currentDay,\n      onDayClick: handleDayClick\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 589,\n      columnNumber: 9\n    }, this), user && user.id ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mx-auto p-14 max-w-4xl\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid gap-16\",\n        children: tests.map(dayData => {\n          const dayProgress = getDayProgress(dayData.day, dayData.tasks);\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            id: `day-${dayData.day}`,\n            className: \"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between items-start mb-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1 min-w-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-xl font-bold text-gray-900 dark:text-white mb-1\",\n                  children: [t('days.day', \"День\"), \" \", dayData.day]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 609,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-lg text-gray-800 dark:text-gray-200 font-medium\",\n                  children: t(dayData.titleKey)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 612,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 608,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex flex-col items-end space-y-1 flex-shrink-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center space-x-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-sm font-semibold text-gray-600 dark:text-gray-400\",\n                    children: [dayProgress, \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 619,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"w-20 bg-gray-200 dark:bg-gray-700 rounded-full h-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"bg-blue-500 h-2 rounded-full transition-all duration-300\",\n                      style: {\n                        width: `${dayProgress}%`\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 623,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 622,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 618,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-500 dark:text-gray-400\",\n                  children: [dayData.tasks.length, \" \", t('days.tasks', \"заданий\")]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 629,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 617,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 607,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-3\",\n              children: dayData.tasks.map((task, index) => {\n                const isAnswerCorrect = isCorrectAnswerCheck(dayData.day, index, task.answer, answers);\n                const hasAnswer = answers[`${dayData.day}-${index}`];\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `p-4 rounded-lg ${hasAnswer ? isAnswerCorrect ? 'bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800' : 'bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800' : 'bg-gray-50 dark:bg-gray-700'}`,\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center space-x-3\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"flex-1 text-gray-800 dark:text-gray-200\",\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: [t('tasks.task', \"Задача\"), \" \", index + 1, \":\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 650,\n                        columnNumber: 31\n                      }, this), \" \", task.question]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 649,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center space-x-2\",\n                      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                        type: \"text\",\n                        placeholder: t('answer', \"Ответ\"),\n                        value: answers[`${dayData.day}-${index}`] || \"\",\n                        onChange: e => handleAnswerChange(dayData.day, index, e.target.value),\n                        className: \"w-24 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-center\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 654,\n                        columnNumber: 31\n                      }, this), hasAnswer && (isAnswerCorrect ? /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-green-500 text-xl\",\n                        title: t('correct', \"Правильно!\"),\n                        children: \"\\u2705\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 663,\n                        columnNumber: 35\n                      }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-red-500 text-xl\",\n                        title: t('try_again', \"Попробуйте еще раз\"),\n                        children: \"\\u274C\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 665,\n                        columnNumber: 35\n                      }, this))]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 653,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 648,\n                    columnNumber: 27\n                  }, this), task.answerFormat && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-xs text-gray-500 dark:text-gray-400 mt-1\",\n                    children: [\"\\uD83D\\uDCA1 \", t('answerFormat.hint', \"Формат ответа\"), \": \", task.answerFormat]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 672,\n                    columnNumber: 29\n                  }, this), hasAnswer && !isAnswerCorrect && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-md\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm text-blue-800 dark:text-blue-200\",\n                      children: [\"\\uD83D\\uDCA1 \", task.explanation]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 679,\n                      columnNumber: 31\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 678,\n                    columnNumber: 29\n                  }, this)]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 641,\n                  columnNumber: 25\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 635,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600\",\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                href: dayData.theoryLink,\n                target: \"_blank\",\n                rel: \"noopener noreferrer\",\n                className: \"text-blue-600 dark:text-blue-400 hover:underline text-sm flex items-center\",\n                children: [\"\\uD83D\\uDCD6 \", t('days.theory', \"Теоретические материалы\"), \" \\\"\", t(dayData.titleKey), \"\\\"\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 690,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 689,\n              columnNumber: 19\n            }, this)]\n          }, dayData.day, true, {\n            fileName: _jsxFileName,\n            lineNumber: 606,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 601,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-8 text-center text-gray-500 dark:text-gray-400 text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: t('footer.course_description', \"Курс для закрепления знаний по математике за 6 класс\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 705,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"\\xA9 2025 Math Academy | \", t('footer.generated', \"Задания генерируются случайно\")]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 706,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 704,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 600,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen flex items-center justify-center px-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center max-w-2xl mx-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-8 flex justify-center\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-32 h-32 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-6xl\",\n            children: \"\\uD83D\\uDCDA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 713,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 712,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-6\",\n          children: t('auth.welcome', \"Добро пожаловать в Math Academy!\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 718,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-md mx-auto leading-relaxed\",\n          children: t('auth.prompt', \"Войдите или зарегистрируйтесь чтобы начать обучение\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 722,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col sm:flex-row gap-4 justify-center mb-12\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleLoginClick,\n            className: \"bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-lg font-medium text-lg transition-colors shadow-lg\",\n            children: t('header.login', \"Войти\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 727,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleRegisterClick,\n            className: \"bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-lg font-medium text-lg transition-colors shadow-lg\",\n            children: t('header.register', \"Регистрация\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 733,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 726,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"border-t border-gray-200 dark:border-gray-700 pt-8\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-lg text-gray-500 dark:text-gray-400 italic\",\n            children: t('slogan', \"От математических основ к образовательной экосистеме! 🚀\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 742,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 741,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 711,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 710,\n      columnNumber: 9\n    }, this), showResetConfirm && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-lg p-6 m-4 max-w-md w-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-bold text-gray-900 dark:text-white mb-2\",\n          children: [\"\\uD83D\\uDD04 \", t('reset.new_tasks', \"Новые задания\")]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 753,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 dark:text-gray-400 mb-4\",\n          children: t('reset.confirmation', \"Вы уверены, что хотите сгенерировать новые задания? Весь текущий прогресс будет сброшен.\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 756,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowResetConfirm(false),\n            className: \"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700\",\n            children: t('reset.cancel', \"Отмена\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 760,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              resetProgress();\n              setShowResetConfirm(false);\n            },\n            className: \"flex-1 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors\",\n            children: t('reset.generate', \"Сгенерировать\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 766,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 759,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 752,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 751,\n      columnNumber: 9\n    }, this), showScrollTop && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      }),\n      className: \"fixed bottom-6 right-6 z-50 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-full w-10 h-10 flex items-center justify-center shadow-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100\",\n      \"aria-label\": \"\\u041D\\u0430\\u0432\\u0435\\u0440\\u0445\",\n      children: \"\\u2191\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 781,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 542,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"PHGTu1owMhaXk3nDSheN/nq9+0A=\", false, function () {\n  return [useTranslation];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","Header","Login","Register","authAPI","courseAPI","userAPI","courseStructure","taskGenerators","useTranslation","DayNavigation","jsxDEV","_jsxDEV","applyTranslationsToTasks","tasks","t","map","task","question","translationKey","translationParams","explanation","explanationKey","explanationParams","answerFormat","formatKey","syncProgressWithServer","localAnswers","localTests","length","dayData","saveTasks","day","Object","keys","key","answer","entries","index","split","Number","find","d","isCorrectAnswer","isCorrectAnswerCheck","saveAnswer","console","log","error","loadProgressFromServer","progressResponse","answersResponse","tasksResponse","Promise","all","getProgress","catch","data","getAnswers","getTasks","serverProgress","answers","tests","progress","correctAnswer","currentAnswers","_currentAnswers","userAnswer","toString","trim","toLowerCase","correct","includes","userNum","replace","correctNum","userA","userB","correctA","correctB","App","_s","i18n","setTests","setAnswers","loading","setLoading","showResetConfirm","setShowResetConfirm","user","setUser","showLogin","setShowLogin","showRegister","setShowRegister","currentDay","setCurrentDay","showScrollTop","setShowScrollTop","authError","setAuthError","isSyncing","setIsSyncing","progressLoaded","setProgressLoaded","handleScroll","window","scrollY","addEventListener","removeEventListener","initializeUserProgress","localStorage","getItem","finalTests","finalAnswers","isLoggedIn","values","parsedTests","JSON","parse","parsedAnswers","titleKey","theoryLink","generator","taskCount","setItem","stringify","newTests","checkAuth","token","savedUser","userData","response","getMe","name","email","handleCacheClearRecovery","hasTests","hasAnswers","hasLocalData","recoveredTests","recoveredAnswers","timer","setTimeout","clearTimeout","handleLogin","formData","login","password","access_token","_error$response","_error$response$data","errorMessage","detail","message","handleRegister","register","username","grade","loginResponse","_error$response2","_error$response2$data","handleLogout","removeItem","handleAnswerChange","value","newAnswers","completedTasks","filter","i","updateProgress","getDayProgress","correctCount","Math","round","getTotalProgress","totalCorrect","totalTasks","forEach","resetProgress","userTests","handleLoginClick","handleRegisterClick","handleDayClick","dayNumber","element","document","getElementById","headerOffset","elementPosition","offsetTop","offsetPosition","scrollTo","top","max","behavior","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onResetClick","onSettingsClick","onLoginClick","onLogoutClick","onLogin","onSwitchToRegister","onRegister","onSwitchToLogin","id","days","onDayClick","dayProgress","style","width","isAnswerCorrect","hasAnswer","type","placeholder","onChange","e","target","title","href","rel","onClick","_c","$RefreshReg$"],"sources":["/opt/math-app/frontend/src/App.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\nimport Header from \"./components/Header\";\nimport Login from \"./components/auth/Login\";\nimport Register from \"./components/auth/Register\";\nimport { authAPI, courseAPI, userAPI } from './services/api';\nimport { courseStructure } from './taskGenerators';\nimport * as taskGenerators from './taskGenerators';\nimport { useTranslation } from 'react-i18next';\nimport DayNavigation from './components/DayNavigation';\n\n// Функция для применения переводов к заданиям\nconst applyTranslationsToTasks = (tasks, t) => {\n  return tasks.map(task => ({\n    ...task,\n    question: task.translationKey ? t(task.translationKey, task.translationParams) : task.question,\n    explanation: task.explanationKey ? t(task.explanationKey, task.explanationParams) : task.explanation,\n    answerFormat: task.formatKey ? t(task.formatKey) : task.answerFormat\n  }));\n};\n\n// 🟢 ФУНКЦИЯ ДЛЯ СИНХРОНИЗАЦИИ ПРОГРЕССА\nconst syncProgressWithServer = async (localAnswers, localTests) => {\n  try {\n    // Сохраняем тесты на сервер\n    if (localTests && localTests.length > 0) {\n      for (const dayData of localTests) {\n        await userAPI.saveTasks(dayData.day, dayData.tasks);\n      }\n    }\n\n    // Сохраняем ответы на сервер\n    if (localAnswers && Object.keys(localAnswers).length > 0) {\n      for (const [key, answer] of Object.entries(localAnswers)) {\n        const [day, index] = key.split('-').map(Number);\n        const dayData = localTests.find(d => d.day === day);\n        if (dayData && dayData.tasks[index]) {\n          const task = dayData.tasks[index];\n          const isCorrectAnswer = isCorrectAnswerCheck(day, index, task.answer, localAnswers);\n          await userAPI.saveAnswer(day, index, answer, isCorrectAnswer);\n        }\n      }\n    }\n\n    console.log('✅ Прогресс синхронизирован с сервером');\n    return true;\n  } catch (error) {\n    console.error('❌ Ошибка синхронизации прогресса:', error);\n    return false;\n  }\n};\n\n// 🟢 ФУНКЦИЯ ДЛЯ ЗАГРУЗКИ ПРОГРЕССА С СЕРВЕРА\nconst loadProgressFromServer = async () => {\n  try {\n    const [progressResponse, answersResponse, tasksResponse] = await Promise.all([\n      courseAPI.getProgress().catch(() => ({ data: {} })),\n      userAPI.getAnswers('all').catch(() => ({ data: {} })),\n      userAPI.getTasks('all').catch(() => ({ data: {} }))\n    ]);\n\n    const serverProgress = {\n      answers: answersResponse.data || {},\n      tests: tasksResponse.data || {},\n      progress: progressResponse.data || {}\n    };\n\n    console.log('📥 Прогресс загружен с сервера:', serverProgress);\n    return serverProgress;\n  } catch (error) {\n    console.error('❌ Ошибка загрузки прогресса с сервера:', error);\n    return { answers: {}, tests: {}, progress: {} };\n  }\n};\n\n// 🟢 ФУНКЦИЯ ПРОВЕРКИ ПРАВИЛЬНОСТИ ОТВЕТА (вынесена для переиспользования)\nconst isCorrectAnswerCheck = (day, index, correctAnswer, currentAnswers) => {\n  const userAnswer = currentAnswers[`${day}-${index}`]?.toString().trim().toLowerCase();\n  const correct = correctAnswer.toString().toLowerCase();\n  \n  if (!userAnswer) return false;\n  \n  if (correct.includes('%')) {\n    const userNum = userAnswer.replace('%', '');\n    const correctNum = correct.replace('%', '');\n    return userNum === correctNum;\n  }\n\n  if (correct.includes('/')) {\n    const [userA, userB] = userAnswer.split('/');\n    const [correctA, correctB] = correct.split('/');\n    return userA === correctA && userB === correctB;\n  }\n\n  return userAnswer === correct;\n};\n\nfunction App() {\n  const { t, i18n } = useTranslation();\n  const [tests, setTests] = useState([]);\n  const [answers, setAnswers] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [showResetConfirm, setShowResetConfirm] = useState(false);\n  const [user, setUser] = useState(null);\n  const [showLogin, setShowLogin] = useState(false);\n  const [showRegister, setShowRegister] = useState(false);\n  const [currentDay, setCurrentDay] = useState(1);\n  const [showScrollTop, setShowScrollTop] = useState(false);\n  const [authError, setAuthError] = useState('');\n  const [isSyncing, setIsSyncing] = useState(false);\n  const [progressLoaded, setProgressLoaded] = useState(false);\n\n  // 🟢 EFFECT ДЛЯ ОТСЛЕЖИВАНИЯ СКРОЛЛА\n  useEffect(() => {\n    const handleScroll = () => {\n      setShowScrollTop(window.scrollY > 300);\n    };\n    window.addEventListener('scroll', handleScroll);\n    return () => window.removeEventListener('scroll', handleScroll);\n  }, []);\n\n  // 🟢 УЛУЧШЕННАЯ ИНИЦИАЛИЗАЦИЯ ПРОГРЕССА ПОЛЬЗОВАТЕЛЯ\n  const initializeUserProgress = useCallback(async () => {\n    if (progressLoaded) return; // Защита от повторной загрузки\n    \n    setIsSyncing(true);\n    \n    try {\n      // 1. Всегда загружаем прогресс с сервера для авторизованных пользователей\n      const serverProgress = await loadProgressFromServer();\n      \n      // 2. Проверяем localStorage\n      const localTests = localStorage.getItem('userMathTests');\n      const localAnswers = localStorage.getItem('userMathAnswers');\n      \n      let finalTests = [];\n      let finalAnswers = {};\n\n      // 3. ДЛЯ АВТОРИЗОВАННЫХ ПОЛЬЗОВАТЕЛЕЙ: приоритет у сервера\n      if (user && user.isLoggedIn) {\n        if (serverProgress.tests && Object.keys(serverProgress.tests).length > 0) {\n          // Используем данные с сервера\n          finalTests = Object.values(serverProgress.tests).map(dayData => ({\n            ...dayData,\n            tasks: applyTranslationsToTasks(dayData.tasks, t)\n          }));\n          finalAnswers = serverProgress.answers || {};\n          console.log('🔄 Используем данные с сервера для авторизованного пользователя');\n        } \n        else if (localTests && localAnswers) {\n          // Сервер пустой, но есть локальные данные - синхронизируем\n          const parsedTests = JSON.parse(localTests);\n          const parsedAnswers = JSON.parse(localAnswers);\n          \n          finalTests = parsedTests.map(dayData => ({\n            ...dayData,\n            tasks: applyTranslationsToTasks(dayData.tasks, t)\n          }));\n          finalAnswers = parsedAnswers;\n          \n          await syncProgressWithServer(parsedAnswers, parsedTests);\n          console.log('🔄 Синхронизировали локальные данные с сервером');\n        }\n        else {\n          // Нет данных вообще - генерируем новые\n          finalTests = courseStructure.map(day => ({\n            day: day.day,\n            titleKey: day.titleKey,\n            theoryLink: day.theoryLink,\n            tasks: taskGenerators[day.generator](day.taskCount, t)\n          }));\n          \n          await syncProgressWithServer({}, finalTests);\n          console.log('🔄 Сгенерировали новые задания для авторизованного пользователя');\n        }\n      } \n      // 4. ДЛЯ ГОСТЕЙ: используем только localStorage\n      else {\n        if (localTests && localAnswers) {\n          const parsedTests = JSON.parse(localTests);\n          const parsedAnswers = JSON.parse(localAnswers);\n          \n          finalTests = parsedTests.map(dayData => ({\n            ...dayData,\n            tasks: applyTranslationsToTasks(dayData.tasks, t)\n          }));\n          finalAnswers = parsedAnswers;\n          console.log('🔄 Используем локальные данные для гостя');\n        } else {\n          finalTests = courseStructure.map(day => ({\n            day: day.day,\n            titleKey: day.titleKey,\n            theoryLink: day.theoryLink,\n            tasks: taskGenerators[day.generator](day.taskCount, t)\n          }));\n          console.log('🔄 Сгенерировали новые задания для гостя');\n        }\n      }\n\n      // 5. Сохраняем финальные данные\n      setTests(finalTests);\n      setAnswers(finalAnswers);\n      localStorage.setItem('userMathTests', JSON.stringify(finalTests));\n      localStorage.setItem('userMathAnswers', JSON.stringify(finalAnswers));\n      setProgressLoaded(true);\n\n    } catch (error) {\n      console.error('❌ Ошибка инициализации прогресса:', error);\n      \n      // Фолбэк на localStorage или новую генерацию\n      const localTests = localStorage.getItem('userMathTests');\n      const localAnswers = localStorage.getItem('userMathAnswers');\n      \n      if (localTests && localAnswers) {\n        const parsedTests = JSON.parse(localTests);\n        const parsedAnswers = JSON.parse(localAnswers);\n        \n        setTests(parsedTests.map(dayData => ({\n          ...dayData,\n          tasks: applyTranslationsToTasks(dayData.tasks, t)\n        })));\n        setAnswers(parsedAnswers);\n      } else {\n        const newTests = courseStructure.map(day => ({\n          day: day.day,\n          titleKey: day.titleKey,\n          theoryLink: day.theoryLink,\n          tasks: taskGenerators[day.generator](day.taskCount, t)\n        }));\n        setTests(newTests);\n        localStorage.setItem('userMathTests', JSON.stringify(newTests));\n      }\n      setProgressLoaded(true);\n    } finally {\n      setIsSyncing(false);\n    }\n  }, [user, t, progressLoaded]);\n\n  // 🟢 ПРОВЕРКА АУТЕНТИФИКАЦИИ С СИНХРОНИЗАЦИЕЙ ПРОГРЕССА\n  const checkAuth = useCallback(async () => {\n    try {\n      const token = localStorage.getItem('authToken');\n      const savedUser = localStorage.getItem('userData');\n      \n      if (token && savedUser) {\n        const userData = JSON.parse(savedUser);\n        setUser(userData);\n        \n        // 🟢 ЗАГРУЖАЕМ И СИНХРОНИЗИРУЕМ ПРОГРЕСС ПОСЛЕ ЛОГИНА\n        if (userData.isLoggedIn) {\n          await initializeUserProgress();\n        }\n      } else if (token) {\n        try {\n          const response = await authAPI.getMe();\n          const userData = {\n            ...response.data,\n            isLoggedIn: true\n          };\n          setUser(userData);\n          localStorage.setItem('userData', JSON.stringify(userData));\n          \n          // 🟢 ЗАГРУЖАЕМ И СИНХРОНИЗИРУЕМ ПРОГРЕСС\n          await initializeUserProgress();\n        } catch (error) {\n          console.log('getMe failed, using fallback user');\n          const userData = {\n            name: 'Пользователь',\n            email: 'user@example.com', \n            isLoggedIn: true\n          };\n          setUser(userData);\n          localStorage.setItem('userData', JSON.stringify(userData));\n        }\n      } else {\n        setUser({ name: t('header.guest', \"Гость\"), isLoggedIn: false });\n        await initializeUserProgress(); // Загружаем прогресс для гостя\n      }\n    } catch (error) {\n      console.error('Auth check error:', error);\n      setUser({ name: t('header.guest', \"Гость\"), isLoggedIn: false });\n    } finally {\n      setLoading(false);\n    }\n  }, [t, initializeUserProgress]);\n\n  useEffect(() => {\n    checkAuth();\n  }, [checkAuth]);\n\n  // 🟢 КРИТИЧЕСКИЙ FIX: ВОССТАНОВЛЕНИЕ ПРОГРЕССА ПРИ СБРОСЕ КЭША SAFARI\n  useEffect(() => {\n    const handleCacheClearRecovery = async () => {\n      // Если пользователь авторизован, но прогресс пустой - загружаем с сервера\n      const token = localStorage.getItem('authToken');\n      const hasTests = tests.length > 0;\n      const hasAnswers = Object.keys(answers).length > 0;\n      const hasLocalData = localStorage.getItem('userMathTests') && localStorage.getItem('userMathAnswers');\n      \n      if (token && (!hasTests || !hasAnswers || !hasLocalData)) {\n        console.log('🔄 Safari cache clear detected - recovering progress from server...');\n        setIsSyncing(true);\n        \n        try {\n          const serverProgress = await loadProgressFromServer();\n          \n          if (serverProgress.tests && Object.keys(serverProgress.tests).length > 0) {\n            const recoveredTests = Object.values(serverProgress.tests).map(dayData => ({\n              ...dayData,\n              tasks: applyTranslationsToTasks(dayData.tasks, t)\n            }));\n            \n            const recoveredAnswers = serverProgress.answers || {};\n            \n            setTests(recoveredTests);\n            setAnswers(recoveredAnswers);\n            localStorage.setItem('userMathTests', JSON.stringify(recoveredTests));\n            localStorage.setItem('userMathAnswers', JSON.stringify(recoveredAnswers));\n            \n            console.log('✅ Progress recovered from server after Safari cache clear');\n          } else {\n            // Если на сервере нет данных, но пользователь авторизован - генерируем новые\n            const newTests = courseStructure.map(day => ({\n              day: day.day,\n              titleKey: day.titleKey,\n              theoryLink: day.theoryLink,\n              tasks: taskGenerators[day.generator](day.taskCount, t)\n            }));\n            \n            setTests(newTests);\n            localStorage.setItem('userMathTests', JSON.stringify(newTests));\n            await syncProgressWithServer({}, newTests);\n            console.log('🔄 Generated new tasks after cache clear');\n          }\n        } catch (error) {\n          console.error('❌ Recovery failed:', error);\n        } finally {\n          setIsSyncing(false);\n        }\n      }\n    };\n\n    // Запускаем проверку после полной загрузки компонента\n    const timer = setTimeout(handleCacheClearRecovery, 2000);\n    return () => clearTimeout(timer);\n  }, [user, tests.length, Object.keys(answers).length, t]);\n\n  // 🟢 ОБРАБОТЧИК ВХОДА С СИНХРОНИЗАЦИЕЙ\n  const handleLogin = async (formData) => {\n    console.log('🔐 LOGIN ATTEMPT:', formData);\n    setAuthError('');\n    \n    try {\n      const response = await authAPI.login({ \n        email: formData.email, \n        password: formData.password \n      });\n      console.log('✅ LOGIN SUCCESS:', response.data);\n      \n      localStorage.setItem('authToken', response.data.access_token);\n      await checkAuth(); // Это вызовет initializeUserProgress\n      setShowLogin(false);\n    } catch (error) {\n      console.error('❌ LOGIN ERROR:', error);\n      const errorMessage = error.response?.data?.detail || error.message || 'Ошибка входа';\n      setAuthError(errorMessage);\n    }\n  };\n\n  // 🟢 ОБРАБОТЧИК РЕГИСТРАЦИИ\n  const handleRegister = async (formData) => {\n    console.log('📝 REGISTER ATTEMPT:', formData);\n    setAuthError('');\n    \n    try {\n      const response = await authAPI.register({ \n        email: formData.email,\n        username: formData.username, \n        password: formData.password,\n        grade: formData.grade\n      });\n      console.log('✅ REGISTER SUCCESS:', response.data);\n      \n      const loginResponse = await authAPI.login({\n        email: formData.email,\n        password: formData.password\n      });\n      localStorage.setItem('authToken', loginResponse.data.access_token);\n      await checkAuth();\n      setShowRegister(false);\n    } catch (error) {\n      console.error('❌ REGISTER ERROR:', error);\n      const errorMessage = error.response?.data?.detail || error.message || 'Ошибка регистрации';\n      setAuthError(errorMessage);\n    }\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('userData');\n    localStorage.removeItem('userMathTests');\n    localStorage.removeItem('userMathAnswers');\n    setUser({ name: t('header.guest', \"Гость\"), isLoggedIn: false });\n    setAnswers({});\n    setTests([]);\n    setAuthError('');\n    setProgressLoaded(false);\n  };\n\n  // 🟢 УЛУЧШЕННАЯ ОБРАБОТКА ВВОДА ОТВЕТА С СИНХРОНИЗАЦИЕЙ\n  const handleAnswerChange = async (day, index, value) => {\n    const newAnswers = {\n      ...answers,\n      [`${day}-${index}`]: value\n    };\n    \n    // Немедленно обновляем UI\n    setAnswers(newAnswers);\n    localStorage.setItem('userMathAnswers', JSON.stringify(newAnswers));\n    \n    try {\n      const dayData = tests.find(d => d.day === day);\n      if (dayData) {\n        const task = dayData.tasks[index];\n        const isCorrectAnswer = isCorrectAnswerCheck(day, index, task.answer, newAnswers);\n        \n        // Сохраняем ответ на сервер\n        await userAPI.saveAnswer(day, index, value, isCorrectAnswer);\n        \n        // Обновляем прогресс дня\n        const completedTasks = dayData.tasks.filter((t, i) => \n          isCorrectAnswerCheck(day, i, t.answer, newAnswers)\n        ).length;\n        \n        await courseAPI.updateProgress(day, newAnswers, completedTasks);\n        \n        console.log('✅ Ответ сохранен и синхронизирован');\n      }\n    } catch (error) {\n      console.error('❌ Ошибка сохранения в базу:', error);\n      // Ответ останется в localStorage и будет синхронизирован при следующей возможности\n    }\n  };\n\n  // Прогресс дня\n  const getDayProgress = (day, tasks) => {\n    const correctCount = tasks.filter((t, i) =>\n      isCorrectAnswerCheck(day, i, t.answer, answers)\n    ).length;\n    return Math.round((correctCount / tasks.length) * 100);\n  };\n\n  // Общий прогресс\n  const getTotalProgress = () => {\n    let totalCorrect = 0;\n    let totalTasks = 0;\n\n    tests.forEach(dayData => {\n      dayData.tasks.forEach((task, index) => {\n        totalTasks++;\n        if (isCorrectAnswerCheck(dayData.day, index, task.answer, answers)) {\n          totalCorrect++;\n        }\n      });\n    });\n\n    return totalTasks ? Math.round((totalCorrect / totalTasks) * 100) : 0;\n  };\n\n  // 🟢 УЛУЧШЕННЫЙ СБРОС ПРОГРЕССА\n  const resetProgress = async () => {\n    try {\n      // Генерируем новые задания\n      const userTests = courseStructure.map(day => ({\n        day: day.day,\n        titleKey: day.titleKey,\n        theoryLink: day.theoryLink,\n        tasks: taskGenerators[day.generator](day.taskCount, t)\n      }));\n      \n      // Обновляем состояние\n      setTests(userTests);\n      setAnswers({});\n      \n      // Сохраняем локально\n      localStorage.setItem('userMathTests', JSON.stringify(userTests));\n      localStorage.setItem('userMathAnswers', JSON.stringify({}));\n      \n      // Синхронизируем с сервером\n      await courseAPI.resetProgress();\n      \n      // Сохраняем новые тесты на сервер\n      for (const dayData of userTests) {\n        await userAPI.saveTasks(dayData.day, dayData.tasks);\n      }\n      \n      console.log('✅ Прогресс полностью сброшен и синхронизирован');\n    } catch (error) {\n      console.error('❌ Error resetting progress:', error);\n      // Локальные данные уже сброшены, сервер синхронизируется при следующей возможности\n    }\n  };\n\n  const handleLoginClick = () => {\n    setShowLogin(true);\n    setAuthError('');\n  };\n\n  const handleRegisterClick = () => {\n    setShowRegister(true);\n    setAuthError('');\n  };\n\n  const handleDayClick = (dayNumber) => {\n    setCurrentDay(dayNumber);\n    const element = document.getElementById(`day-${dayNumber}`);\n    if (element) {\n      const headerOffset = 340;\n      const elementPosition = element.offsetTop;\n      const offsetPosition = elementPosition - headerOffset;\n\n      setTimeout(() => {\n        window.scrollTo({\n          top: Math.max(0, offsetPosition),\n          behavior: 'smooth'\n        });\n      }, 50);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600 dark:text-gray-400\">{t('loading', \"Загрузка...\")}</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200\">\n      <Header \n        user={user || { name: t('header.guest', \"Гость\"), isLoggedIn: false }}\n        progress={getTotalProgress()}\n        onResetClick={() => setShowResetConfirm(true)}\n        onSettingsClick={() => console.log(\"Settings clicked\")}\n        onLoginClick={handleLoginClick}\n        onLogoutClick={handleLogout}\n        grade=\"6\"\n      />\n\n      {showLogin && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <Login \n            onLogin={handleLogin} \n            onSwitchToRegister={() => { \n              setShowLogin(false); \n              setShowRegister(true); \n              setAuthError('');\n            }}\n            error={authError}\n          />\n        </div>\n      )}\n\n      {showRegister && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <Register \n            onRegister={handleRegister} \n            onSwitchToLogin={() => { \n              setShowRegister(false); \n              setShowLogin(true); \n              setAuthError('');\n            }}\n            error={authError}\n          />\n        </div>\n      )}\n\n      {isSyncing && (\n        <div className=\"fixed top-20 left-1/2 transform -translate-x-1/2 z-40 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2\">\n          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n          <span>{t('syncing', \"Синхронизация прогресса...\")}</span>\n        </div>\n      )}\n\n      {user && user.id && tests.length > 0 && (\n        <DayNavigation \n          days={tests.map(day => ({\n            ...day,\n            progress: getDayProgress(day.day, day.tasks)\n          }))}\n          currentDay={currentDay}\n          onDayClick={handleDayClick}\n        />\n      )}\n\n      {user && user.id ? (\n        <div className=\"container mx-auto p-14 max-w-4xl\">\n          <div className=\"grid gap-16\">\n            {tests.map(dayData => {\n              const dayProgress = getDayProgress(dayData.day, dayData.tasks);\n              \n              return (\n                <div key={dayData.day} id={`day-${dayData.day}`} className=\"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6\">\n                  <div className=\"flex justify-between items-start mb-4\">\n                    <div className=\"flex-1 min-w-0\">\n                      <h2 className=\"text-xl font-bold text-gray-900 dark:text-white mb-1\">\n                        {t('days.day', \"День\")} {dayData.day}\n                      </h2>\n                      <p className=\"text-lg text-gray-800 dark:text-gray-200 font-medium\">\n                        {t(dayData.titleKey)}\n                      </p>\n                    </div>\n                    \n                    <div className=\"flex flex-col items-end space-y-1 flex-shrink-0\">\n                      <div className=\"flex items-center space-x-2\">\n                        <span className=\"text-sm font-semibold text-gray-600 dark:text-gray-400\">\n                          {dayProgress}%\n                        </span>\n                        <div className=\"w-20 bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\n                          <div \n                            className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\n                            style={{ width: `${dayProgress}%` }}\n                          />\n                        </div>\n                      </div>\n                      <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                        {dayData.tasks.length} {t('days.tasks', \"заданий\")}\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-3\">\n                    {dayData.tasks.map((task, index) => {\n                      const isAnswerCorrect = isCorrectAnswerCheck(dayData.day, index, task.answer, answers);\n                      const hasAnswer = answers[`${dayData.day}-${index}`];\n                      \n                      return (\n                        <div key={index} className={`p-4 rounded-lg ${\n                          hasAnswer \n                            ? isAnswerCorrect \n                              ? 'bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800'\n                              : 'bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800'\n                            : 'bg-gray-50 dark:bg-gray-700'\n                        }`}>\n                          <div className=\"flex items-center space-x-3\">\n                            <span className=\"flex-1 text-gray-800 dark:text-gray-200\">\n                              <strong>{t('tasks.task', \"Задача\")} {index + 1}:</strong> {task.question}\n                            </span>\n\n                            <div className=\"flex items-center space-x-2\">\n                              <input\n                                type=\"text\"\n                                placeholder={t('answer', \"Ответ\")}\n                                value={answers[`${dayData.day}-${index}`] || \"\"}\n                                onChange={e => handleAnswerChange(dayData.day, index, e.target.value)}\n                                className=\"w-24 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-center\"\n                              />\n                              {hasAnswer && (\n                                isAnswerCorrect ? (\n                                  <span className=\"text-green-500 text-xl\" title={t('correct', \"Правильно!\")}>✅</span>\n                                ) : (\n                                  <span className=\"text-red-500 text-xl\" title={t('try_again', \"Попробуйте еще раз\")}>❌</span>\n                                )\n                              )}\n                            </div>\n                          </div>\n                          \n                          {task.answerFormat && (\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                              💡 {t('answerFormat.hint', \"Формат ответа\")}: {task.answerFormat}\n                            </div>\n                          )}\n                          \n                          {hasAnswer && !isAnswerCorrect && (\n                            <div className=\"mt-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-md\">\n                              <p className=\"text-sm text-blue-800 dark:text-blue-200\">\n                                💡 {task.explanation}\n                              </p>\n                            </div>\n                          )}\n                        </div>\n                      );\n                    })}\n                  </div>\n\n                  <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600\">\n                    <a\n                      href={dayData.theoryLink}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className=\"text-blue-600 dark:text-blue-400 hover:underline text-sm flex items-center\"\n                    >\n                      📖 {t('days.theory', \"Теоретические материалы\")} \"{t(dayData.titleKey)}\"\n                    </a>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n\n          <div className=\"mt-8 text-center text-gray-500 dark:text-gray-400 text-sm\">\n            <p>{t('footer.course_description', \"Курс для закрепления знаний по математике за 6 класс\")}</p>\n            <p>© 2025 Math Academy | {t('footer.generated', \"Задания генерируются случайно\")}</p>\n          </div>\n        </div>\n      ) : (\n        <div className=\"min-h-screen flex items-center justify-center px-4\">\n          <div className=\"text-center max-w-2xl mx-auto\">\n            <div className=\"mb-8 flex justify-center\">\n              <div className=\"w-32 h-32 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-6xl\">\n                📚\n              </div>\n            </div>\n            \n            <h1 className=\"text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-6\">\n              {t('auth.welcome', \"Добро пожаловать в Math Academy!\")}\n            </h1>\n            \n            <p className=\"text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-md mx-auto leading-relaxed\">\n              {t('auth.prompt', \"Войдите или зарегистрируйтесь чтобы начать обучение\")}\n            </p>\n            \n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center mb-12\">\n              <button\n                onClick={handleLoginClick}\n                className=\"bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-lg font-medium text-lg transition-colors shadow-lg\"\n              >\n                {t('header.login', \"Войти\")}\n              </button>\n              <button\n                onClick={handleRegisterClick}\n                className=\"bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-lg font-medium text-lg transition-colors shadow-lg\"\n              >\n                {t('header.register', \"Регистрация\")}\n              </button>\n            </div>\n            \n            <div className=\"border-t border-gray-200 dark:border-gray-700 pt-8\">\n              <p className=\"text-lg text-gray-500 dark:text-gray-400 italic\">\n                {t('slogan', \"От математических основ к образовательной экосистеме! 🚀\")}\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showResetConfirm && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6 m-4 max-w-md w-full\">\n            <h3 className=\"text-lg font-bold text-gray-900 dark:text-white mb-2\">\n              🔄 {t('reset.new_tasks', \"Новые задания\")}\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\n              {t('reset.confirmation', \"Вы уверены, что хотите сгенерировать новые задания? Весь текущий прогресс будет сброшен.\")}\n            </p>\n            <div className=\"flex space-x-3\">\n              <button\n                onClick={() => setShowResetConfirm(false)}\n                className=\"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700\"\n              >\n                {t('reset.cancel', \"Отмена\")}\n              </button>\n              <button\n                onClick={() => {\n                  resetProgress();\n                  setShowResetConfirm(false);\n                }}\n                className=\"flex-1 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors\"\n              >\n                {t('reset.generate', \"Сгенерировать\")}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showScrollTop && (\n        <button \n          onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}\n          className=\"fixed bottom-6 right-6 z-50 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-full w-10 h-10 flex items-center justify-center shadow-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100\"\n          aria-label=\"Наверх\"\n        >\n          ↑\n        </button>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}